<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <record model="ir.ui.view" id="helpdesk_ticket_view_form">
    <field name="name">helpdesk ticket view form</field>
    <field name="model">helpdesk.ticket</field>
    <field name="arch" type="xml">
      <form string="Helpdesk Ticket">
        <header>
          <button string="Assign to me" name="assign_to_me" type="object"/>
          <field name="stage_id" widget="statusbar" options="{'clickable': '1'}" attrs="{'invisible': False}"/>
        </header>
        <sheet>
          <group name="main" string="Ticket and Customer">
            <h3>
              <field name="name" nolabel="1"/>
              -
              <field name="partner_id"/>
            </h3>
          </group>

          <group name="description" string="Description">
            <h3>
              <field name="description" nolabel="1"/>
            </h3>
          </group>
          <group name="global">
            <group name="priority">
              <field name="priority" widget="priority"/>
              <field name="date_deadline"/>
            </group>
            <group name="data">
              <field name="team_id"/>
              <field name="user_id"/>
              <field name="company_id"/>
            </group>
            <group name="cause">
              <field name="cause_id"/>
              <field name="decission"/>
              <field name="action_ids"/>
            </group>
          </group>
        </sheet>
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread" options="{'post_refresh': 'recipients'}"/>
        </div>
      </form>
    </field>
  </record>

  <record model="ir.ui.view" id="helpdesk_ticket_view_tree">
    <field name="name">helpdesk ticket view tree</field>
    <field name="model">helpdesk.ticket</field>
    <field name="arch" type="xml">
      <tree string="Helpdesk Ticket">
        <field name="name"/>
        <field name="partner_id"/>
        <field name="description"/>
        <field name="priority" widget="priority"/>
        <field name="date_deadline"/>
      </tree>
    </field>
  </record>

  <record id="helpdesk_ticket_view_kanban" model="ir.ui.view">
    <field name="name">helpdesk ticket view kanban</field>
    <field name="model">helpdesk.ticket</field>
    <field name="priority" eval="100"/>
    <field name="arch" type="xml">
      <kanban class="o_kanban_mobile" archivable="false"  default_group_by="stage_id" >
          <field name="name"/>
          <field name="code"/>
          <field name="partner_id"/>
          <field name="priority"/>
          <field name="date_deadline"/>
          <field name="user_id"/>
          <field name="team_id"/>
          <field name="message_needaction_counter"/>
          <field name="activity_ids"/>
          <field name="activity_state"/>
          <templates>
              <t t-name="kanban-box">
                  <div t-attf-class="oe_kanban_content oe_kanban_global_click">
                      <div>
                          <h2><field name="code"/> - <field name="name"/></h2>
                      </div>
                      <div>
                        Partner:  <span class="o_kanban_record_subtitle"><field name="partner_id"/></span>
                      </div>
                      <div>
                        Team: <field name="team_id"/>
                      </div>
                      <div>
                        <field name="date_deadline"/>
                      </div>
                      <div class="o_kanban_record_bottom">
                          <div class="oe_kanban_bottom_left">
                              <field name="priority" widget="priority"/>
                              <t t-if="record.message_needaction_counter.raw_value">
                                  <span role="alert" class="oe_kanban_mail_new" title="Unread Messages"><i class="fa fa-comments" aria-label="Messages" role="img"/><t t-raw="record.message_needaction_counter.raw_value"/></span>
                              </t>
                              <div class="o_kanban_inline_block">
                                  <field name="activity_ids" widget="kanban_activity"/>
                              </div>
                          </div>
                          <div class="oe_kanban_bottom_right">
                              <img t-att-src="kanban_image('res.users', 'image_small', record.user_id.raw_value)" t-att-title="record.user_id.value" t-att-alt="record.user_id.value" width="24" height="24" class="oe_kanban_avatar float-right"/>
                          </div>
                      </div>
                  </div>
              </t>
          </templates>
      </kanban>
    </field>
  </record>

  <record model="ir.ui.view" id="helpdesk_ticket_view_pivot">
    <field name="name">helpdesk ticket view pivot</field>
    <field name="model">helpdesk.ticket</field>
    <field name="arch" type="xml">
      <pivot string="Helpdesk Ticket" disable_linking="True">
          <field name="create_date" interval="month" type="row"/>
          <field name="cause_id" type="col"/>
      </pivot>
    </field>
  </record>

  <record model="ir.ui.view" id="helpdesk_ticket_view_search">
    <field name="name">helpdesk ticket view search</field>
    <field name="model">helpdesk.ticket</field>
    <field name="arch" type="xml">
      <search string="Helpdesk Ticket">
        <field name="name"/>
        <field name="description"/>
        <field name="partner_id"/>
        <field name="user_id"/>
        <separator/>
        <filter string="Very Hight Priority" name="very_hight_priority" domain="[('priority', '=', '3')]"/>
        <filter string="Date limit" name="date_limit" date="date_deadline"/>
        <filter string="Assigned to me" name="user_id" domain="[('user_id', '=', uid)]"/>
        <group expand="0" string="Group By">
            <filter string="Cause" name="cause_id" domain="[]" context="{'group_by':'cause_id'}"/>
        </group>
      </search>
    </field>
  </record>

</odoo>
